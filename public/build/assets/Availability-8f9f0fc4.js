import{T as q}from"./TableSection-cddd6cd9.js";import{_ as B}from"./FormModal-2ee5cb69.js";import{_ as y}from"./InputForm-9c83281e.js";import{_ as F}from"./SelectForm-96aa9d9e.js";import{C as _}from"./Carbon-e7b34390.js";import{I as C,c as O}from"./helpers-216f0a78.js";import{r as w,T as A,j as N,g as z,o as l,c as i,a as n,f,F as h,h as b,e as I,u as a,d as S,b as r,t as d,k as U,O as j}from"./app-4678c2f9.js";import{t as v}from"./toast-222764f6.js";import{I as L}from"./IconEdit-ea038fb8.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./createVueComponent-c8464d70.js";const G=r("th",null,"Dia",-1),J=r("th",null,"Horario",-1),Y=r("th",null,"Sorteos",-1),K=r("th",null,"Acciones",-1),P={class:"whitespace-nowrap"},Q={class:"badge-blue m-1 whitespace-nowrap"},R={class:"flex items-center gap-3"},W=["onClick"],X=["onClick"],Z=r("option",{value:"",disabled:"",selected:""},"Seleccione un dia",-1),ee=["value"],te={key:1,class:"text-sm text-red-600 mb-4"},oe={class:"grid grid-cols-2 gap-2"},re={key:2,class:"text-sm text-red-600 mt-1"},se={class:"flex gap-3 mt-5"},ae={class:"text-xs inline-flex items-center font-bold leading-sm px-3 py-1 bg-indigo-200 text-indigo-700 rounded-full"},le={class:"mr-3"},ie={role:"button",tooltip:"Eliminar"},ke={__name:"Availability",props:{availability:{type:Object,required:!0},raffle:{type:Object,required:!0},openModal:{type:Boolean,required:!0}},emits:["update:openModal"],setup(g,{emit:V}){const c=g,u=w(null),p=w(!0),t=A({id:null,order:null,day:null,start_time:"07:00:00",end_time:"21:00:00",raffle_id:c.raffle.id,blocked_hours:["11:00:00","15:00:00","21:00:00"]}),x=[{order:0,name:"Domingo"},{order:1,name:"Lunes"},{order:2,name:"Martes"},{order:3,name:"Miercoles"},{order:4,name:"Jueves"},{order:5,name:"Viernes"},{order:6,name:"Sabado"}],T=N(()=>{let o=[];return x.forEach(s=>{c.availability.find(e=>e.day==s.name)||o.push(s)}),o});z(()=>t.order,o=>{o&&(t.day=x.find(s=>s.order==o).name)});const k=()=>{t.reset(),V("update:openModal",!1)},E=o=>{t.id=o.id,t.start_time=o.start_time,t.end_time=o.end_time,t.blocked_hours=o.blocked_hours,p.value=!1,V("update:openModal",!0)},D=()=>{if(!u.value){v.error("Debe seleccionar una hora");return}u.value&&(t.blocked_hours.find(o=>o==u.value)||t.blocked_hours.push(u.value+":00"),u.value=null)},$=()=>{p.value?t.post(route("clientarea.raffles.availability.store",c.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{k(),v.success("Guardado correctamente")}}):t.put(route("clientarea.raffles.availability.update",[c.raffle.id,t.id]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{k(),v.success("Actualizado correctamente")}})},H=o=>{t.blocked_hours.splice(o,1)},M=o=>{O({message:"¿Está seguro de eliminar este registro?",onConfirm:()=>{j.delete(route("clientarea.raffles.availability.destroy",[c.raffle.id,o]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{v.success("Eliminado correctamente")},onError:s=>{console.log(s)}})}})};return(o,s)=>(l(),i("div",null,[n(q,null,{header:f(()=>[G,J,Y,K]),body:f(()=>[(l(!0),i(h,null,b(g.availability,e=>(l(),i("tr",null,[r("td",null,d(e.order)+" - "+d(e.day),1),r("td",null,[r("span",P,d(a(_).create().setTime(e.start_time).getTimeFormat())+" - ",1),U(" "+d(a(_).create().setTime(e.end_time).getTimeFormat()),1)]),r("td",null,[(l(!0),i(h,null,b(e.blocked_hours,m=>(l(),i("div",Q,d(a(_).create().setTime(m).getTimeFormat()),1))),256))]),r("td",null,[r("div",R,[r("span",{tooltip:"Editar",role:"button",onClick:m=>E(e)},[n(a(L),{size:"22"})],8,W),r("span",{tooltip:"Eliminar",role:"button",onClick:m=>M(e.id)},[n(a(C),{size:"22"})],8,X)])])]))),256))]),_:1}),n(B,{show:g.openModal,title:"Horario",onOnCancel:k,onOnSubmit:$},{default:f(()=>[p.value?(l(),I(F,{key:0,modelValue:a(t).order,"onUpdate:modelValue":s[0]||(s[0]=e=>a(t).order=e),text:"Dia",required:""},{default:f(()=>[Z,(l(!0),i(h,null,b(T.value,e=>(l(),i("option",{value:e.order},d(e.name),9,ee))),256))]),_:1},8,["modelValue"])):S("",!0),T.value.length==0&&p.value?(l(),i("p",te," Ya se ha registrado todos los dias ")):S("",!0),r("div",oe,[n(y,{text:"Hora incio",modelValue:a(t).start_time,"onUpdate:modelValue":s[1]||(s[1]=e=>a(t).start_time=e),type:"time",required:""},null,8,["modelValue"]),n(y,{text:"Hora fin",modelValue:a(t).end_time,"onUpdate:modelValue":s[2]||(s[2]=e=>a(t).end_time=e),type:"time",required:""},null,8,["modelValue"])]),n(y,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=e=>u.value=e),type:"time",text:"Sorteo"},null,8,["modelValue"]),r("button",{type:"button",class:"primary-button",onClick:D}," Agregar "),o.$page.props.errors.blocked_hours?(l(),i("p",re,d(o.$page.props.errors.blocked_hours),1)):S("",!0),r("div",se,[(l(!0),i(h,null,b(a(t).blocked_hours,(e,m)=>(l(),i("div",ae,[r("span",le,d(a(_).create().setTime(e).getTimeFormat()),1),r("span",ie,[n(a(C),{size:"15",onClick:ne=>H(m)},null,8,["onClick"])])]))),256))])]),_:1},8,["show"])]))}};export{ke as default};
