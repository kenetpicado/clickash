import{T as N}from"./TableSection-33c2a5bf.js";import{T as B,r as F,j as b,g as O,o as a,c as l,a as h,f as m,F as y,h as v,d as V,b as e,t as s,u as o,e as x,k}from"./app-d1da7f39.js";import{_ as j}from"./FormModal-c58e4b12.js";import{_ as q}from"./InputForm-6e3b7c8a.js";import{_ as w}from"./SelectForm-3b3fc554.js";import{C as i}from"./Carbon-e7b34390.js";import{t as f}from"./toast-097b2c37.js";import{c as $}from"./helpers-b8266d48.js";import"./_plugin-vue_export-helper-c27b6911.js";const H=e("th",null,"Vendedor",-1),M=e("th",null,"Cliente",-1),z=e("th",null,"Turno",-1),E=e("th",null,"Numero",-1),L=e("th",null,"Premio",-1),U=e("th",null,"Fecha",-1),Y={class:"whitespace-nowrap"},A={class:"font-semibold"},D={class:"text-sm"},P={key:0},G=e("td",{colspan:"6",class:"text-center"},"No hay datos",-1),R=[G],W=e("th",{colspan:"4",class:"text-end"}," Total ",-1),I=e("th",null,null,-1),J={class:"grid grid-cols-2 gap-2"},K=e("option",{value:"",disabled:"",selected:""},"Seleccione un turno",-1),Q=["value"],X={key:0,class:"text-red-500 mb-4"},Z={key:1,class:"text-gray-400 text-sm"},ee={key:2,class:"mt-5 text-basic"},te={class:"font-bold"},ce={__name:"WinningNumber",props:{results:{type:Object,required:!0},raffle:{type:Object,required:!0},openModal:{type:Boolean,required:!0},currentBlockedHours:{type:Object,required:!0},winners:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:openModal"],setup(d,{emit:T}){const c=d,r=B({number:null,hour:null}),p=F(null),_=b(()=>c.currentBlockedHours.length==0?[]:c.currentBlockedHours[0].blocked_hours),g=()=>{r.reset(),p.value=null,T("update:openModal",!1)},C=()=>{if(c.results.find(n=>n.hour==r.hour)){f.error("Ya existe un resultado para este turno");return}$({title:"Confirmar",message:"Â¿Esta seguro de agregar este resultado?",onConfirm:()=>{r.post(route("clientarea.raffles.winning-numbers.store",c.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g(),f.success("Guardado correctamente")},onError:n=>{f.error(n.message)}})}})};O(p,n=>{n?r.number=i.create(n).format("d/m"):r.number=null});const S=b(()=>c.winners.reduce((n,u)=>n+parseFloat(u.prize),0));return(n,u)=>(a(),l("div",null,[h(N,null,{header:m(()=>[H,M,z,E,L,U]),body:m(()=>[(a(!0),l(y,null,v(d.winners,t=>(a(),l("tr",null,[e("td",null,s(t.user.name),1),e("td",null,s(t.client),1),e("td",null,[e("span",Y,s(o(i).create().setTime(t.hour).getTimeFormat()),1)]),e("td",null,[e("span",A,s(t.digit),1)]),e("td",null,[e("span",D," C$"+s(t.prize.toLocaleString()),1)]),e("td",null,s(o(i).create(t.created_at).format("d/m/Y")),1)]))),256)),d.winners.length==0?(a(),l("tr",P,R)):V("",!0)]),footer:m(()=>[e("tfoot",null,[e("tr",null,[W,e("th",null," C$"+s(S.value.toLocaleString()),1),I])])]),_:1}),h(j,{show:d.openModal,title:"Resultado",onOnCancel:g,onOnSubmit:C},{default:m(()=>[e("div",J,[h(w,{modelValue:o(r).hour,"onUpdate:modelValue":u[0]||(u[0]=t=>o(r).hour=t),text:"Turno",required:""},{default:m(()=>[K,(a(!0),l(y,null,v(_.value,t=>(a(),l("option",{value:t},s(o(i).create().setTime(t).getTimeFormat()),9,Q))),256))]),_:1},8,["modelValue"]),d.settings.date?(a(),x(q,{key:0,modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=t=>p.value=t),type:"date",text:"Fecha",required:""},null,8,["modelValue"])):(a(),x(q,{key:1,modelValue:o(r).number,"onUpdate:modelValue":u[2]||(u[2]=t=>o(r).number=t),type:"number",text:"Numero",required:""},null,8,["modelValue"]))]),_.value.length==0?(a(),l("div",X,' No se encontraron turnos disponibles para el dia en curso. Por favor, verifique la disponibilidad en "Horario" ')):(a(),l("div",Z," Verifique que los datos ingresados sean correctos antes de guardar, ya que para garantizar la integridad de los datos no se permite eliminar ni editar los resultados. ")),o(r).number&&o(r).hour?(a(),l("div",ee,[k(" Agregando el numero ganador: "),e("span",te,s(o(r).number),1),k(" a la rifa "+s(d.raffle.name)+" para el turno de las "+s(o(i).create().setTime(o(r).hour).getTimeFormat())+" del corriente dia: "+s(o(i).create().format("d/m/Y"))+". ",1)])):V("",!0)]),_:1},8,["show"])]))}};export{ce as default};
