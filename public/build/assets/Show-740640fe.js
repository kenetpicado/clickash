import{T as N}from"./TableSection-01aa3d88.js";import{_ as I,C as h}from"./Carbon-e91db77a.js";import{_ as M}from"./AppLayout-2e849277.js";import{_ as q}from"./AddButton-7c371a3e.js";import{_ as p}from"./InputForm-12e18036.js";import{_ as O}from"./FormModal-c1d866eb.js";import{r as w,T as E,j as U,o as l,e as b,f as u,b as e,t as n,d as _,n as S,c as i,h as k,F as V,a as d,u as s,k as z,O as A}from"./app-2259b7ab.js";import{t as g}from"./toast-1af94a2c.js";import{I as R,c as J}from"./helpers-666f40da.js";import{I as G}from"./IconEdit-865e50c0.js";import"./_plugin-vue_export-helper-c27b6911.js";const K={class:"title"},P={class:"flex gap-3 overflow-x-auto hide-scrollbar mb-4"},Q=e("th",null,"Vendedor",-1),W=e("th",null,"Turno",-1),X=e("th",null,"Monto",-1),Y=e("th",null,"Numero",-1),Z={class:"text-xs text-gray-400 mb-1"},ee={class:"mb-1"},te={class:"text-gray-400"},oe={class:"badge-blue whitespace-nowrap"},le={class:"font-semibold"},se={key:0},ne=e("td",{colspan:"4",class:"text-center"},"No hay datos",-1),ie=[ne],ae=e("th",null,"Numero",-1),re=e("th",null,"Limite individual",-1),ue=e("th",null,"Limite general",-1),de=e("th",null,"Acciones",-1),me={class:"font-semibold"},ce={key:0,class:"badge-red"},_e={key:1},fe={key:0,class:"badge-red"},be={key:1},ve=["onClick"],he={key:0},pe=e("td",{colspan:"4",class:"text-center"},"No hay datos",-1),ge=[pe],ye=e("th",null,"Dia",-1),ke=e("th",null,"Horario",-1),Ve=e("th",null,"Sorteos",-1),Ce=e("th",null,"Acciones",-1),xe={class:"whitespace-nowrap"},Ne={class:"badge-blue m-1 whitespace-nowrap"},we=["onClick"],Se={class:"grid grid-cols-2 gap-2"},Ie={__name:"Show",props:{raffle:{type:Object,required:!0},transactions:{type:Object,required:!0},blockeds:{type:Object,required:!0},availability:{type:Object,required:!0}},setup(c){const f=c,D=[{name:"Inicio",route:route("clientarea.index")},{name:"Rifas",route:route("clientarea.raffles.index")},{name:f.raffle.name,route:route("clientarea.raffles.show",f.raffle.id)}],r=w(0),C=w(!1),y=w(!1),a=E({number:null,settings:{general_limit:null,individual_limit:null}}),v=E({order:null,day:null,start_time:"07:00:00",end_time:"07:00:00"}),F=[{order:0,name:"Domingo"},{order:1,name:"Lunes"},{order:2,name:"Martes"},{order:3,name:"Miercoles"},{order:4,name:"Jueves"},{order:5,name:"Viernes"},{order:6,name:"Sabado"}],L=U(()=>{let m=[];return F.forEach(o=>{f.availability.find(t=>t.day==o.name)||m.push(o)}),m}),T=()=>{if(isNaN(a.number)){g.error("Numero invalido");return}if(!a.settings.general_limit&&!a.settings.individual_limit){g.error("Debe ingresar al menos un limite");return}if(f.blockeds.find(m=>m.number==a.number)){g.error("Numero ya bloqueado");return}a.post(route("clientarea.raffles.blocked-numbers.store",f.raffle.id),{onSuccess:()=>{$(),g.success("Numero bloqueado")}})},$=()=>{a.reset(),C.value=!1},j=()=>{v.reset(),y.value=!1},B=m=>{console.log(m),y.value=!0},H=m=>{J({message:"¿Está seguro de eliminar este registro?",onConfirm:()=>{A.delete(route("clientarea.raffles.blocked-numbers.destroy",[f.raffle.id,m]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g.success("Eliminado correctamente")},onError:o=>{console.log(o)}})}})};return(m,o)=>(l(),b(M,{title:"Rifa",breads:D},{header:u(()=>[e("span",K,n(c.raffle.name),1),r.value==1?(l(),b(q,{key:0,onClick:o[0]||(o[0]=t=>C.value=!0)})):_("",!0),r.value==2?(l(),b(q,{key:1,onClick:o[1]||(o[1]=t=>y.value=!0)})):_("",!0)]),default:u(()=>[e("div",P,[e("div",{class:S(r.value==0?"active-tab":"inactive-tab"),onClick:o[2]||(o[2]=t=>r.value=0),role:"button"}," Ventas ",2),e("div",{class:S(r.value==1?"active-tab":"inactive-tab"),onClick:o[3]||(o[3]=t=>r.value=1),role:"button"}," Bloqueados ",2),e("div",{class:S(r.value==2?"active-tab":"inactive-tab"),onClick:o[4]||(o[4]=t=>r.value=2),role:"button"}," Disponibilidad ",2)]),r.value==0?(l(),b(N,{key:0},{header:u(()=>[Q,W,X,Y]),body:u(()=>[(l(!0),i(V,null,k(c.transactions.data,t=>(l(),i("tr",null,[e("td",null,[e("div",Z," #"+n(t.id)+" - "+n(s(h).create(t.created_at).diffForHumans()),1),e("div",ee,n(t.user.name),1),e("div",te,n(t.client),1)]),e("td",null,[e("span",oe,n(s(h).create().setTime(t.hour).getTimeFormat()),1)]),e("td",null," C$"+n(t.amount),1),e("td",null,[e("span",le," #"+n(t.digit),1)])]))),256)),c.transactions.data.length==0?(l(),i("tr",se,ie)):_("",!0)]),paginator:u(()=>[d(I,{links:c.transactions.links},null,8,["links"])]),_:1})):_("",!0),r.value==1?(l(),b(N,{key:1},{header:u(()=>[ae,re,ue,de]),body:u(()=>[(l(!0),i(V,null,k(c.blockeds,t=>(l(),i("tr",null,[e("td",me,n(t.number),1),e("td",null,[t.settings.individual_limit?(l(),i("span",ce," C$"+n(t.settings.individual_limit),1)):(l(),i("span",_e," Ninguno "))]),e("td",null,[t.settings.general_limit?(l(),i("span",fe," C$"+n(t.settings.general_limit),1)):(l(),i("span",be," Ninguno "))]),e("td",null,[e("span",{tooltip:"Eliminar",role:"button",onClick:x=>H(t.id)},[d(s(R),{size:"22"})],8,ve)])]))),256)),c.blockeds.length==0?(l(),i("tr",he,ge)):_("",!0)]),_:1})):_("",!0),r.value==2?(l(),b(N,{key:2},{header:u(()=>[ye,ke,Ve,Ce]),body:u(()=>[(l(!0),i(V,null,k(c.availability,t=>(l(),i("tr",null,[e("td",null,n(t.day),1),e("td",null,[e("span",xe,n(s(h).create().setTime(t.start_time).getTimeFormat())+" - ",1),z(" "+n(s(h).create().setTime(t.end_time).getTimeFormat()),1)]),e("td",null,[(l(!0),i(V,null,k(t.blocked_hours,x=>(l(),i("div",Ne,n(s(h).create().setTime(x).getTimeFormat()),1))),256))]),e("td",null,[e("span",{tooltip:"Editar",role:"button",onClick:x=>B(t)},[d(s(G),{size:"22"})],8,we)])]))),256))]),_:1})):_("",!0),d(O,{show:C.value,title:"Numero bloqueado",onOnCancel:$,onOnSubmit:T},{default:u(()=>[d(p,{text:"Numero",modelValue:s(a).number,"onUpdate:modelValue":o[5]||(o[5]=t=>s(a).number=t),type:"number",required:""},null,8,["modelValue"]),d(p,{text:"Limite individual",modelValue:s(a).settings.individual_limit,"onUpdate:modelValue":o[6]||(o[6]=t=>s(a).settings.individual_limit=t),type:"number"},null,8,["modelValue"]),d(p,{text:"Limite general",modelValue:s(a).settings.general_limit,"onUpdate:modelValue":o[7]||(o[7]=t=>s(a).settings.general_limit=t),type:"number"},null,8,["modelValue"])]),_:1},8,["show"]),d(O,{show:y.value,title:"Horario",onOnCancel:j,onOnSubmit:T},{default:u(()=>[e("pre",null,n(L.value),1),e("div",Se,[d(p,{text:"Hora incio",modelValue:s(v).start_time,"onUpdate:modelValue":o[8]||(o[8]=t=>s(v).start_time=t),type:"time",required:""},null,8,["modelValue"]),d(p,{text:"Hora fin",modelValue:s(v).end_time,"onUpdate:modelValue":o[9]||(o[9]=t=>s(v).end_time=t),type:"time",required:""},null,8,["modelValue"])])]),_:1},8,["show"])]),_:1}))}};export{Ie as default};
