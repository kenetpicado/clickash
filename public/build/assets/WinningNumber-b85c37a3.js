import{T as N}from"./TableSection-45687886.js";import{T as B,r as F,j as b,g as O,o as a,c as l,a as h,f as m,F as y,h as v,d as V,b as e,t as r,u as s,e as x,k}from"./app-f1f7eb69.js";import{_ as j}from"./FormModal-3577dbb1.js";import{_ as q}from"./InputForm-3c597ec4.js";import{_ as w}from"./SelectForm-a13ca638.js";import{C as i}from"./Carbon-e7b34390.js";import{t as _}from"./toast-395c8648.js";import{c as H}from"./helpers-93ecc6bd.js";import"./_plugin-vue_export-helper-c27b6911.js";const $=e("th",null,"Vendedor",-1),E=e("th",null,"Cliente",-1),M=e("th",null,"Turno",-1),z=e("th",null,"Numero",-1),L=e("th",null,"Premio",-1),U=e("th",null,"Estado",-1),Y=e("th",null,"Fecha",-1),A={class:"whitespace-nowrap"},D={class:"font-semibold"},P={class:"text-sm"},G={class:"badge-primary"},R={key:0},W=e("td",{colspan:"6",class:"text-center"},"No hay datos",-1),I=[W],J=e("th",{colspan:"4",class:"text-end"}," Total ",-1),K=e("th",null,null,-1),Q={class:"grid grid-cols-2 gap-2"},X=e("option",{value:"",disabled:"",selected:""},"Seleccione un turno",-1),Z=["value"],ee={key:0,class:"text-red-500 mb-4"},te={key:1,class:"text-gray-400 text-sm"},oe={key:2,class:"mt-5 text-basic"},re={class:"font-bold"},pe={__name:"WinningNumber",props:{results:{type:Object,required:!0},raffle:{type:Object,required:!0},openModal:{type:Boolean,required:!0},currentBlockedHours:{type:Object,required:!0},winners:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:openModal"],setup(d,{emit:T}){const c=d,o=B({number:null,hour:null}),p=F(null),f=b(()=>c.currentBlockedHours.length==0?[]:c.currentBlockedHours[0].blocked_hours),g=()=>{o.reset(),p.value=null,T("update:openModal",!1)},C=()=>{if(c.results.find(n=>n.hour==o.hour)){_.error("Ya existe un resultado para este turno");return}H({title:"Confirmar",message:"Â¿Esta seguro de agregar este resultado?",onConfirm:()=>{o.post(route("clientarea.raffles.winning-numbers.store",c.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g(),_.success("Guardado correctamente")},onError:n=>{_.error(n.message)}})}})};O(p,n=>{n?o.number=i.create(n).format("d/m"):o.number=null});const S=b(()=>c.winners.reduce((n,u)=>n+parseFloat(u.prize),0));return(n,u)=>(a(),l("div",null,[h(N,null,{header:m(()=>[$,E,M,z,L,U,Y]),body:m(()=>[(a(!0),l(y,null,v(d.winners,t=>(a(),l("tr",null,[e("td",null,r(t.user.name),1),e("td",null,r(t.client),1),e("td",null,[e("span",A,r(s(i).create().setTime(t.hour).getTimeFormat()),1)]),e("td",null,[e("span",D,r(t.digit),1)]),e("td",null,[e("span",P," C$"+r(t.prize.toLocaleString()),1)]),e("td",null,[e("span",G,r(t.status),1)]),e("td",null,r(s(i).create(t.created_at).format("d/m/Y H:i")),1)]))),256)),d.winners.length==0?(a(),l("tr",R,I)):V("",!0)]),footer:m(()=>[e("tfoot",null,[e("tr",null,[J,e("th",null," C$"+r(S.value.toLocaleString()),1),K])])]),_:1}),h(j,{show:d.openModal,title:"Resultado",onOnCancel:g,onOnSubmit:C},{default:m(()=>[e("div",Q,[h(w,{modelValue:s(o).hour,"onUpdate:modelValue":u[0]||(u[0]=t=>s(o).hour=t),text:"Turno",required:""},{default:m(()=>[X,(a(!0),l(y,null,v(f.value,t=>(a(),l("option",{value:t},r(s(i).create().setTime(t).getTimeFormat()),9,Z))),256))]),_:1},8,["modelValue"]),d.settings.date?(a(),x(q,{key:0,modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=t=>p.value=t),type:"date",text:"Fecha",required:""},null,8,["modelValue"])):(a(),x(q,{key:1,modelValue:s(o).number,"onUpdate:modelValue":u[2]||(u[2]=t=>s(o).number=t),type:"number",text:"Numero",required:""},null,8,["modelValue"]))]),f.value.length==0?(a(),l("div",ee,' No se encontraron turnos disponibles para el dia en curso. Por favor, verifique la disponibilidad en "Horario" ')):(a(),l("div",te," Verifique que los datos ingresados sean correctos antes de guardar, ya que para garantizar la integridad de los datos no se permite eliminar ni editar los resultados. ")),s(o).number&&s(o).hour?(a(),l("div",oe,[k(" Agregando el numero ganador: "),e("span",re,r(s(o).number),1),k(" a la rifa "+r(d.raffle.name)+" para el turno de las "+r(s(i).create().setTime(s(o).hour).getTimeFormat())+" del corriente dia: "+r(s(i).create().format("d/m/Y"))+". ",1)])):V("",!0)]),_:1},8,["show"])]))}};export{pe as default};
