import{T as H}from"./TableSection-4d52a19c.js";import{_ as $}from"./FormModal-d9d9b03a.js";import{_ as v}from"./InputForm-96fbdb63.js";import{_ as q}from"./SelectForm-d7cbb6cb.js";import{C as p}from"./Carbon-e7b34390.js";import{I as S,c as M}from"./helpers-bba50f09.js";import{r as O,T as F,j as B,g as j,o as l,c as n,a as i,f as _,F as f,h,u as s,b as t,t as u,d as A,k as I,O as N}from"./app-6addb345.js";import{t as g}from"./toast-f5c64931.js";import{I as U}from"./IconEdit-3ec7a515.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./createVueComponent-654ebc59.js";const z=t("th",null,"Dia",-1),L=t("th",null,"Horario",-1),J=t("th",null,"Sorteos",-1),G=t("th",null,"Acciones",-1),K={class:"whitespace-nowrap"},P={class:"badge-blue m-1 whitespace-nowrap"},Q={class:"flex items-center gap-3"},R=["onClick"],W=["onClick"],X=t("option",{value:"",disabled:"",selected:""},"Seleccione un dia",-1),Y=["value"],Z={class:"grid grid-cols-2 gap-2"},ee={key:0,class:"text-sm text-red-600 mt-1"},te={class:"flex gap-4 mt-3"},oe={class:"text-xs inline-flex items-center font-bold leading-sm px-3 py-1 bg-indigo-200 text-indigo-700 rounded-full m-1"},re={class:"mr-3"},ae={role:"button",tooltip:"Eliminar"},be={__name:"Availability",props:{availability:{type:Object,required:!0},raffle:{type:Object,required:!0},auth:{type:Object,required:!0},openModal:{type:Boolean,required:!0}},emits:["update:openModal"],setup(b,{emit:y}){const c=b,d=O(null),a=F({order:null,day:null,start_time:"07:00:00",end_time:"21:00:00",raffle_id:c.raffle.id,user_id:c.auth.id,blocked_hours:[]}),k=[{order:0,name:"Domingo"},{order:1,name:"Lunes"},{order:2,name:"Martes"},{order:3,name:"Miercoles"},{order:4,name:"Jueves"},{order:5,name:"Viernes"},{order:6,name:"Sabado"}],x=B(()=>{let o=[];return k.forEach(r=>{c.availability.find(e=>e.day==r.name)||o.push(r)}),o});j(()=>a.order,o=>{o&&(a.day=k.find(r=>r.order==o).name)});const V=()=>{a.reset(),y("update:openModal",!1)},T=o=>{console.log(o),y("update:openModal",!0)},C=()=>{if(!d.value){g.error("Debe seleccionar una hora");return}d.value&&(a.blocked_hours.find(o=>o==d.value)||a.blocked_hours.push(d.value+":00"),d.value=null)},w=()=>{a.post(route("clientarea.raffles.availability.store",c.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{V(),g.success("Horario agregado")}})},E=o=>{a.blocked_hours.splice(o,1)},D=o=>{M({message:"¿Está seguro de eliminar este registro?",onConfirm:()=>{N.delete(route("clientarea.raffles.availability.destroy",[c.raffle.id,o]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g.success("Eliminado correctamente")},onError:r=>{console.log(r)}})}})};return(o,r)=>(l(),n("div",null,[i(H,null,{header:_(()=>[z,L,J,G]),body:_(()=>[(l(!0),n(f,null,h(b.availability,e=>(l(),n("tr",null,[t("td",null,u(e.day),1),t("td",null,[t("span",K,u(s(p).create().setTime(e.start_time).getTimeFormat())+" - ",1),I(" "+u(s(p).create().setTime(e.end_time).getTimeFormat()),1)]),t("td",null,[(l(!0),n(f,null,h(e.blocked_hours,m=>(l(),n("div",P,u(s(p).create().setTime(m).getTimeFormat()),1))),256))]),t("td",null,[t("div",Q,[t("span",{tooltip:"Editar",role:"button",onClick:m=>T(e)},[i(s(U),{size:"22"})],8,R),t("span",{tooltip:"Eliminar",role:"button",onClick:m=>D(e.id)},[i(s(S),{size:"22"})],8,W)])])]))),256))]),_:1}),i($,{show:b.openModal,title:"Horario",onOnCancel:V,onOnSubmit:w},{default:_(()=>[i(q,{modelValue:s(a).order,"onUpdate:modelValue":r[0]||(r[0]=e=>s(a).order=e),text:"Dia",required:""},{default:_(()=>[X,(l(!0),n(f,null,h(x.value,e=>(l(),n("option",{value:e.order},u(e.name),9,Y))),256))]),_:1},8,["modelValue"]),t("div",Z,[i(v,{text:"Hora incio",modelValue:s(a).start_time,"onUpdate:modelValue":r[1]||(r[1]=e=>s(a).start_time=e),type:"time",required:""},null,8,["modelValue"]),i(v,{text:"Hora fin",modelValue:s(a).end_time,"onUpdate:modelValue":r[2]||(r[2]=e=>s(a).end_time=e),type:"time",required:""},null,8,["modelValue"])]),i(v,{modelValue:d.value,"onUpdate:modelValue":r[3]||(r[3]=e=>d.value=e),type:"time",text:"Sorteo"},null,8,["modelValue"]),t("button",{type:"button",class:"primary-button",onClick:C}," Agregar "),o.$page.props.errors.blocked_hours?(l(),n("p",ee,u(o.$page.props.errors.blocked_hours),1)):A("",!0),t("div",te,[(l(!0),n(f,null,h(s(a).blocked_hours,(e,m)=>(l(),n("div",oe,[t("span",re,u(s(p).create().setTime(e).getTimeFormat()),1),t("span",ae,[i(s(S),{size:"15",onClick:se=>E(m)},null,8,["onClick"])])]))),256))])]),_:1},8,["show"])]))}};export{be as default};
