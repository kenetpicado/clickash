import{T as C}from"./TableSection-7cab68ca.js";import{T as S,r as N,e as F,l as O,o as a,c as l,a as p,g as c,F as g,f as b,d as y,b as e,t as r,u as s,k as V,j as v}from"./app-820371dd.js";import{_ as j}from"./FormModal-741a8c2e.js";import{_ as x}from"./InputForm-f2283471.js";import{_ as w}from"./SelectForm-5dfee507.js";import{C as i}from"./Carbon-e7b34390.js";import{t as f}from"./toast-711cc5a4.js";import{c as B}from"./helpers-ee3a5683.js";import"./_plugin-vue_export-helper-c27b6911.js";const $=e("th",null,"Vendedor",-1),E=e("th",null,"Cliente",-1),M=e("th",null,"Turno",-1),z=e("th",null,"Numero",-1),L=e("th",null,"Premio",-1),U=e("th",null,"Estado",-1),Y=e("th",null,"Fecha",-1),A={class:"whitespace-nowrap"},D={class:"font-semibold"},H={class:"text-sm"},P={class:"badge-primary"},G={key:0},R=e("td",{colspan:"6",class:"text-center"},"No hay datos",-1),W=[R],I=e("th",{colspan:"4",class:"text-end"}," Total ",-1),J=e("th",null,null,-1),K={class:"grid grid-cols-2 gap-2"},Q=e("option",{value:"",disabled:"",selected:""},"Seleccione un turno",-1),X=["value"],Z={key:0,class:"text-red-500 mb-4"},ee={key:1,class:"text-gray-400 text-sm"},te={key:2,class:"mt-5 text-basic"},oe={class:"font-bold"},me={__name:"WinningNumber",props:{results:{type:Object,required:!0},raffle:{type:Object,required:!0},openModal:{type:Boolean,required:!0},hours:{type:Object,required:!0},winners:{type:Object,required:!0},settings:{type:Object,required:!0}},emits:["update:openModal"],setup(u,{emit:q}){const h=u,o=S({number:null,hour:null}),m=N(null),_=()=>{o.reset(),m.value=null,q("update:openModal",!1)},T=()=>{if(h.results.find(n=>n.hour==o.hour)){f.error("Ya existe un resultado para este turno");return}B({title:"Confirmar",message:"Â¿Esta seguro de agregar este resultado?",onConfirm:()=>{o.post(route("clientarea.raffles.winning-numbers.store",h.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{_(),f.success("Guardado correctamente")},onError:n=>{f.error(n.message)}})}})};F(m,n=>{n?o.number=i.create(n).format("d/m"):o.number=null});const k=O(()=>h.winners.reduce((n,d)=>n+parseFloat(d.prize),0));return(n,d)=>(a(),l("div",null,[p(C,null,{header:c(()=>[$,E,M,z,L,U,Y]),body:c(()=>[(a(!0),l(g,null,b(u.winners,t=>(a(),l("tr",null,[e("td",null,r(t.user.name),1),e("td",null,r(t.client),1),e("td",null,[e("span",A,r(s(i).create().setTime(t.hour).getTimeFormat()),1)]),e("td",null,[e("span",D,r(t.digit),1)]),e("td",null,[e("span",H," C$"+r(t.prize.toLocaleString()),1)]),e("td",null,[e("span",P,r(t.status),1)]),e("td",null,r(s(i).create(t.created_at).format("d/m/Y H:i")),1)]))),256)),u.winners.length==0?(a(),l("tr",G,W)):y("",!0)]),footer:c(()=>[e("tfoot",null,[e("tr",null,[I,e("th",null," C$"+r(k.value.toLocaleString()),1),J])])]),_:1}),p(j,{show:u.openModal,title:"Resultado",onOnCancel:_,onOnSubmit:T},{default:c(()=>[e("div",K,[p(w,{modelValue:s(o).hour,"onUpdate:modelValue":d[0]||(d[0]=t=>s(o).hour=t),text:"Turno",required:""},{default:c(()=>[Q,(a(!0),l(g,null,b(u.hours,t=>(a(),l("option",{value:t},r(s(i).create().setTime(t).getTimeFormat()),9,X))),256))]),_:1},8,["modelValue"]),u.settings.date?(a(),V(x,{key:0,modelValue:m.value,"onUpdate:modelValue":d[1]||(d[1]=t=>m.value=t),type:"date",text:"Fecha",required:""},null,8,["modelValue"])):(a(),V(x,{key:1,modelValue:s(o).number,"onUpdate:modelValue":d[2]||(d[2]=t=>s(o).number=t),type:"number",text:"Numero",required:""},null,8,["modelValue"]))]),u.hours.length==0?(a(),l("div",Z,' No se encontraron turnos disponibles para el dia en curso. Por favor, verifique la disponibilidad en "Horario" ')):(a(),l("div",ee," Verifique que los datos ingresados sean correctos antes de guardar, ya que para garantizar la integridad de los datos no se permite eliminar ni editar los resultados. ")),s(o).number&&s(o).hour?(a(),l("div",te,[v(" Agregando el numero ganador: "),e("span",oe,r(s(o).number),1),v(" a la rifa "+r(u.raffle.name)+" para el turno de las "+r(s(i).create().setTime(s(o).hour).getTimeFormat())+" del corriente dia: "+r(s(i).create().format("d/m/Y"))+". ",1)])):y("",!0)]),_:1},8,["show"])]))}};export{me as default};
