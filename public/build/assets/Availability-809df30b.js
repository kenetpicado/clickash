import{r as w,T as B,l as M,e as z,o as l,k as H,g as d,b as t,c as n,F as v,f as b,a as i,u as r,d as $,t as m,h as A,n as h,j as D,O as U}from"./app-a70b3f65.js";import{_ as L}from"./ClientareaLayout-81d1ef90.js";import{C as y}from"./Carbon-e7b34390.js";import{_ as R}from"./SelectForm-fdff178d.js";import{_ as V}from"./InputForm-4afd10fc.js";import{t as g}from"./toast-bb34ea8c.js";import{_ as G}from"./FormModal-7a2f20d4.js";import{c as J}from"./helpers-bded64ce.js";import{I as K}from"./IconList-f851e203.js";import{M as P,R as Q,h as W,y as N,I as X}from"./IconEdit-4cae7e30.js";import{I as E}from"./IconTrash-41940667.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./createVueComponent-ef26742a.js";const Y=t("span",{class:"title"}," Horario ",-1),Z={key:0,class:"w-full text-center text-gray-400"},ee={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4"},te={class:"bg-card p-4 rounded-xl text-gray-600"},se={class:"flex justify-between items-center mb-2"},re={class:"px-1 py-1"},oe=["onClick"],ae=["onClick"],le={class:"grid grid-cols-2 gap-2 mb-4"},ie=t("strong",{class:"text-sm"},"Hora de inicio",-1),ne=t("strong",{class:"text-sm"},"Hora de fin",-1),de=t("h2",{class:"font-semibold mb-2 text-sm"},"Sorteos",-1),ue={class:"flex items-center gap-3 overflow-x-auto hide-scrollbar text-sm"},ce={class:"inline-flex items-center bg-white px-2 py-1 rounded-xl whitespace-nowrap"},me={key:0,value:"",disabled:"",selected:""},pe={key:1,value:"",disabled:"",selected:""},fe=["value"],_e={class:"grid grid-cols-2 gap-2"},ve={key:1,class:"text-sm text-primaryDark mt-1"},be=t("div",{class:"mt-4 mb-2"}," Sorteos ",-1),he={class:"grid grid-cols-2 lg:grid-cols-3 gap-2"},ye={class:"border px-2 py-1 rounded-xl flex items-center justify-between"},ge={role:"button"},Ie={__name:"Availability",props:{availability:{type:Object,required:!0},raffle:{type:Object,required:!0}},setup(x){const p=x,f=w(!1),_=w(!0),c=w(null),s=B({id:null,order:null,day:null,start_time:"07:00:00",end_time:"21:00:00",raffle_id:p.raffle.id,blocked_hours:["11:00:00","15:00:00","21:00:00"]}),S=[{order:0,name:"Domingo"},{order:1,name:"Lunes"},{order:2,name:"Martes"},{order:3,name:"Miercoles"},{order:4,name:"Jueves"},{order:5,name:"Viernes"},{order:6,name:"Sabado"}],C=M(()=>{let o=[];return S.forEach(a=>{p.availability.find(e=>e.day==a.name)||o.push(a)}),o});z(()=>s.order,o=>{o&&(s.day=S.find(a=>a.order==o).name)});const k=()=>{s.reset(),_.value=!0,f.value=!1,c.value=null},F=o=>{s.id=o.id,s.start_time=o.start_time,s.end_time=o.end_time,s.blocked_hours=o.blocked_hours,_.value=!1,f.value=!0},I=()=>{if(!c.value){g.error("Debe seleccionar una hora");return}c.value&&(s.blocked_hours.find(o=>o==c.value+":00")||s.blocked_hours.push(c.value+":00"),c.value=null)},O=()=>{_.value?s.post(route("clientarea.raffles.availability.store",p.raffle.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{k(),g.success("Guardado correctamente")}}):s.put(route("clientarea.raffles.availability.update",[p.raffle.id,s.id]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{k(),g.success("Actualizado correctamente")}})},j=o=>{s.blocked_hours.splice(o,1)},q=o=>{J({message:"¿Está seguro de eliminar este registro?",onConfirm:()=>{U.delete(route("clientarea.raffles.availability.destroy",[p.raffle.id,o]),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{g.success("Eliminado correctamente")}})}})};return(o,a)=>(l(),H(L,{title:"Horario"},{header:d(()=>[Y,t("button",{type:"button",class:"simple-button",onClick:a[0]||(a[0]=e=>f.value=!0)}," Nuevo ")]),default:d(()=>[x.availability.length==0?(l(),n("div",Z," No hay horario ")):(l(),n("div",ee,[(l(!0),n(v,null,b(x.availability,e=>(l(),n("div",te,[t("div",se,[t("span",null,m(e.day),1),i(r(P),{as:"div",class:"relative inline-block text-left"},{default:d(()=>[i(r(Q),null,{default:d(()=>[i(r(K),{class:"text-primary"})]),_:1}),i(A,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:d(()=>[i(r(W),{class:"absolute z-10 right-0 mt-2 w-56 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:d(()=>[t("div",re,[i(r(N),null,{default:d(({active:u})=>[t("button",{onClick:T=>F(e),class:h([u?"bg-primary text-white":"text-gray-800","group flex w-full items-center rounded-md px-2 py-2 text-sm"])},[i(r(X),{class:h([u?"text-white":"","mr-2 h-5 w-5 text-primary"])},null,8,["class"]),D(" Editar ")],10,oe)]),_:2},1024),i(r(N),null,{default:d(({active:u})=>[t("button",{onClick:T=>q(e.id),class:h([u?"bg-primary text-white":"text-gray-800","group flex w-full items-center rounded-md px-2 py-2 text-sm"])},[i(r(E),{class:h([u?"text-white":"","mr-2 h-5 w-5 text-primary"])},null,8,["class"]),D(" Eliminar ")],10,ae)]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),t("div",le,[t("div",null,[ie,t("div",null,m(r(y).create().setTime(e.start_time).getTimeFormat()),1)]),t("div",null,[ne,t("div",null,m(r(y).create().setTime(e.end_time).getTimeFormat()),1)])]),de,t("div",ue,[(l(!0),n(v,null,b(e.blocked_hours,u=>(l(),n("div",ce,m(r(y).create().setTime(u).getTimeFormat()),1))),256))])]))),256))])),i(G,{show:f.value,title:"Horario",onOnCancel:k,onOnSubmit:O},{default:d(()=>[_.value?(l(),H(R,{key:0,modelValue:r(s).order,"onUpdate:modelValue":a[1]||(a[1]=e=>r(s).order=e),text:"Dia",required:""},{default:d(()=>[C.value.length>0?(l(),n("option",me,"Seleccione un dia")):(l(),n("option",pe,"No hay dias disponibles")),(l(!0),n(v,null,b(C.value,e=>(l(),n("option",{value:e.order},m(e.name),9,fe))),256))]),_:1},8,["modelValue"])):$("",!0),t("div",_e,[i(V,{text:"Hora incio",modelValue:r(s).start_time,"onUpdate:modelValue":a[2]||(a[2]=e=>r(s).start_time=e),type:"time",required:""},null,8,["modelValue"]),i(V,{text:"Hora fin",modelValue:r(s).end_time,"onUpdate:modelValue":a[3]||(a[3]=e=>r(s).end_time=e),type:"time",required:""},null,8,["modelValue"])]),i(V,{modelValue:c.value,"onUpdate:modelValue":a[4]||(a[4]=e=>c.value=e),type:"time",text:"Sorteo"},null,8,["modelValue"]),t("button",{type:"button",class:"primary-button",onClick:I}," Agregar "),o.$page.props.errors.blocked_hours?(l(),n("p",ve,m(o.$page.props.errors.blocked_hours),1)):$("",!0),be,t("div",he,[(l(!0),n(v,null,b(r(s).blocked_hours,(e,u)=>(l(),n("div",ye,[t("span",null,m(r(y).create().setTime(e).getTimeFormat()),1),t("span",ge,[i(r(E),{size:"18",onClick:T=>j(u)},null,8,["onClick"])])]))),256))])]),_:1},8,["show"])]),_:1}))}};export{Ie as default};
